#!/bin/bash

: ${SSH_REMOTE_HOST:=garnet.ciffer.net}

# Run notmuch on remote host
#
# http://notmuchmail.org/remoteusage/
#
# Put (setq notmuch-command "notmuch-remote) in emacs configuration.

# Start a master connection if one isn't running yet
ssh -O check ${SSH_REMOTE_HOST} 2>/dev/null ||
ssh -MNf ${SSH_REMOTE_HOST}

# ControlPersist option (in OpenSSH 5.6) would be very useful here,
# but that option is available in Debian squeeze.

# This requires the bash version of printf (bashism)
printf -v ARGS "%q " "$@"
ssh ${SSH_REMOTE_HOST} notmuch ${ARGS}
